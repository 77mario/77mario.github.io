<!DOCTYPE html>
<html>
<head>
    
  <meta charset="utf-8">
  <title>Smart Insole - Dashboard</title>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
    <style>
      body, html, h2 { margin:0; padding:0; height:100%;}
      body { font-family:sans-serif; }
      body * { font-weight:200;}
      #heatmapContainerWrapper { width:167px;height:370px;background-image: url("feet.png");background-repeat: no-repeat;    background-position: center;display: inline-block;}
      #heatmapContainer { width:100%; height:100%;}
      #heatmapLegend { background:white; bottom:0; right:0; padding:10px; }
      #min { float:left; }
      #max { float:right; }
      h1 { position:absolute; background:black; color:white; padding:10px; font-weight:200;}
    </style>
  <!-- Demo Dependencies -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/holder/2.3.2/holder.min.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script src="https://rawgit.com/chartjs/chartjs-plugin-annotation/master/chartjs-plugin-annotation.js"></script>
  <script>
    Holder.add_theme("white", { background:"#fff", foreground:"#a7a7a7", size:10 });
  </script>
  <script src="timer.js"></script>

  <!-- keen-analysis@1.2.2 -->
  <script src="https://d26b395fwzu5fz.cloudfront.net/keen-analysis-1.2.2.js" type="text/javascript"></script>

  <!-- keen-dataviz@1.1.3 -->
  <link href="https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.css" rel="stylesheet" />
  <script src="https://d26b395fwzu5fz.cloudfront.net/keen-dataviz-1.1.3.js" type="text/javascript"></script>  

  <!-- Dashboard -->
  <link rel="stylesheet" type="text/css" href="../../assets/css/keen-dashboards.css" />
</head>
<body class="keen-dashboard" style="padding-top: 80px;">

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
        </button>
        <!--<a class="navbar-brand" href="../">
          <span class="glyphicon glyphicon-chevron-left"></span>
        </a>-->
        <a class="navbar-brand" href="./">Smart Insole - Dashboard</a>
      </div>
      <div class="navbar-collapse collapse">
        <!--<ul class="nav navbar-nav navbar-left">
          <li><a href="#">Dash</a></li>
          <li><a href="https://keen.io/team">Team</a></li>
          <li><a href="https://github.com/keenlabs/dashboards/tree/gh-pages/layouts/thirds-grid">Source</a></li>
          <li><a href="https://groups.google.com/forum/#!forum/keen-io-devs">Community</a></li><li><a href="http://stackoverflow.com/questions/tagged/keen-io?sort=newest&pageSize=15">Technical Support</a></li>
        </ul>-->
      </div>
    </div>
  </div>

  <div class="container-fluid">

    <div class="row">
      <div class="col-sm-12 col-md-12">
        <div class="chart-wrapper">
          <div class="chart-title">
            Commands Interface
            </div>
            <div class="chart-stage"> <!-- BLOCCO COMANDI -->
            <div class="row row-cards">
                
                
           <div class="col-sm-6 col-lg-3">
                <div class="card p-3">
                  <div class="d-flex align-items-center" style="text-align: center;">
                    <span class="stamp stamp-md bg-blue mr-3" style="display: inline-block; margin-bottom: 20px; margin-top: 20px;">
                      <img src="assets/img/bluetooth.png" width="150" height="150" />
                    </span>
                    <div style="text-align: center;">
                      <button id="connect" class="btn btn-success" onclick="connect();">Connect</button>
                        <br>
                      <small class="text-muted">Connect with STM32</small>
                    </div>
                  </div>
                </div>
            </div>
                
            <div class="col-sm-6 col-lg-3">
                <div class="card p-3">
                  <div class="d-flex align-items-center" style="text-align: center;">
                    <span class="stamp stamp-md bg-blue mr-3" style="display: inline-block; margin-bottom: 20px; margin-top: 20px;">
                      <img src="assets/img/bluetooth.png" width="150" height="150" />
                    </span>
                    <div style="text-align: center;">
                        <button id="staticButton" class="btn btn-primary" onclick="staticFunction()">Static Evaluation</button>   
                        <br>
                        <small class="text-muted">Connect with STM32</small>
                    </div>
                  </div>
                </div>
            </div>     
             <div class="col-sm-6 col-lg-3">
                <div class="card p-3">
                  <div class="d-flex align-items-center" style="text-align: center;">
                    <span class="stamp stamp-md bg-blue mr-3" style="display: inline-block; margin-bottom: 20px; margin-top: 20px;">
                      <img src="assets/img/bluetooth.png" width="150" height="150" />
                    </span>
                    <div style="text-align: center;">
            <button id="#" class="btn btn-warning">Dynamic Evaluation</button>
        <br>
                      <small class="text-muted">Connect with STM32</small>
                    </div>
                  </div>
                </div>
            </div>        
                
            <div class="col-sm-6 col-lg-3">
                <div class="card p-3">
                  <div class="d-flex align-items-center" style="text-align: center;">
                    <span class="stamp stamp-md bg-blue mr-3" style="display: inline-block; margin-bottom: 20px; margin-top: 20px;">
                      <img src="assets/img/bluetooth.png" width="150" height="150" />
                    </span>
                    <div style="text-align: center;">
                        <form>
                            Times (from 10 and 90 sec):
                        <input type="number" name="time-heatmap" min="10" max="90">
                        </form>
                        <br>
                        <button id="#" class="btn btn-danger">Heatmap</button>
                        <br>
                      <small class="text-muted">Return the feet's heatmap after selected time</small>
                    </div>
                  </div>
                </div>
            </div>               
         </div>
          </div>
            <div class="chart-notes">
            *Bluetooth connection is required to connect dashsboard with STM32.
          </div>
          </div>
          
        </div>
      </div>
      <div class="row">
      <div class="col-sm-12 col-md-12">
        <div class="chart-wrapper">
          <div class="chart-title">
            Valutazione dinamica
          </div>
          <div class="chart-stage">
			<!-- Charts dynamic evaluation-->
              <div class="card">
  <div class="card-header">
    <h6 class="card-title">Grafico di apprendimento</h6>
  </div>
  <div class="card-body">
<canvas id="myChart"></canvas>
  </div>
</div>
          </div>
            
          <div class="chart-notes">
            Valore ideale (0) = [Avampiede 55%,Retropiede 45%]. A partire dal valore nominale viene indicato di quanto, in percentule, viene applicata un forza maggiore sull'Avampiede(valore positivo delle ordinato) o alternativamente sul Retropiede (valore negativo delle ordinate).
          </div>
        </div>
      </div>
           </div>
      <div class="row">
      <div class="col-sm-6 col-md-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Valutazione statica - Bar Chart 
          </div>
          <div class="chart-stage">
<canvas id="myChart2"></canvas>
          </div>
          <div class="chart-notes">
            Valori ideali: AVAMPIEDE 45% RETROPIEDE 55%
          </div>
        </div>
      </div>

      <div class="col-sm-6 col-md-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Valutazione statica - Heatmap
          </div>
          <div class="chart-stage" style="text-align: center;">
                <div id="heatmapContainerWrapper">
                <div id="heatmapContainer">

                </div>
                
    </div>
       
    <script src="https://77mario.github.io/heatmap.js-master/build/heatmap.js"></script>
            
          </div>
          <div class="chart-notes">
            <div id="heatmapLegend">
                
                <span id="min"></span>
                <span id="max"></span>
                <img id="gradient" src="" style="width:100%" />
      </div>
          </div>
        </div>
      </div>
           </div>
      <div class="row">
      <div class="col-sm-6 col-md-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Esame Stabilometrico - Oscillazioni M/L (piano frontale destra/sinistra)
          </div>
          <div class="chart-stage">
<div class="card-body">
<canvas id="myChartStabML"></canvas>
  </div>          </div>
          <div class="chart-notes">
            Notes about this chart
          </div>
        </div>
      </div>
      <div class="col-sm-6 col-md-6">
        <div class="chart-wrapper">
          <div class="chart-title">
            Esame Stabilometrico - Oscillazioni A/P (piano sagittale avanti/indietro)
          </div>
          <div class="chart-stage">
              <div class="card-body">
                  <canvas id="myChartStabAP"></canvas>
    </div>             </div>
          <div class="chart-notes">
            Notes about this chart
          </div>
        </div>
      </div>
  </div>
       </div>
  <div class="container-fluid">
    <p class="small text-muted">Layout built by <a href="https://keen.io">Keen IO</a></p>
  </div>

  <!-- Project Analytics -->
  <script type="text/javascript" src="../../assets/js/keen-analytics.js"></script>
  <!-- Footer Script-->
      <script src="https://77mario.github.io/heatmap.js-master/build/heatmap.js"></script>
      <script src="bluetooth.js"></script>

</body>
</html>

<script>
      window.onload = function() {
        // helper function
        function $(id) {
          return document.getElementById(id);
        };
        /*  legend code */
        // we want to display the gradient, so we have to draw it
        var legendCanvas = document.createElement('canvas');
        legendCanvas.width = 100;
        legendCanvas.height = 10;
        var legendCtx = legendCanvas.getContext('2d');
        var gradientCfg = {};
        function updateLegend(data) {
          // the onExtremaChange callback gives us min, max, and the gradientConfig
          // so we can update the legend
          $('min').innerHTML = data.min;
          $('max').innerHTML = data.max;
          // regenerate gradient image
          if (data.gradient != gradientCfg) {
            gradientCfg = data.gradient;
            var gradient = legendCtx.createLinearGradient(0, 0, 100, 1);
            for (var key in gradientCfg) {
              gradient.addColorStop(key, gradientCfg[key]);
            }
            legendCtx.fillStyle = gradient;
            legendCtx.fillRect(0, 0, 100, 10);
            $('gradient').src = legendCanvas.toDataURL();
          }
        };
        /* legend code end */
        // create a heatmap instance
        var heatmap = h337.create({
          container: document.getElementById('heatmapContainer'),
          maxOpacity: .5,
          radius: 20,
          blur: .4,
          // update the legend whenever there's an extrema change
          onExtremaChange: function onExtremaChange(data) {
            updateLegend(data);
          }
        });
        // boundaries for data generation
        var width = (+window.getComputedStyle(document.body).width.replace(/px/,''));
        var height = (+window.getComputedStyle(document.body).height.replace(/px/,''));
        // generate 1000 datapoints
        var generate = function() {
          // randomly generate extremas
          var extremas = [0,100];
          var max = Math.max.apply(Math, extremas);
          var min = Math.min.apply(Math,extremas);
          var t = [];
          
            var c = ((Math.random()* max-min) >> 0) + min;
            var r = (Math.random()* 80) >> 0;

            t.push({ x: 40, y:120, value: 25, radius: 30 });
            t.push({ x: 120, y: 140, value: 90, radius: 30});
            t.push({ x: 75, y:300, value: 75, radius: 30 });

          var init = +new Date;
          // set the generated dataset
          heatmap.setData({
            min: 0,
            max: 100,
            data: t
          });
          console.log('took ', (+new Date) - init, 'ms');
        };
        // initial generate
        generate();
      };
      var legendCanvas = document.createElement('canvas');
legendCanvas.width = 100;
legendCanvas.height = 10;
var min = document.querySelector('#min');
var max = document.querySelector('#max');
var gradientImg = document.querySelector('#gradient');
var legendCtx = legendCanvas.getContext('2d');
var gradientCfg = {};
function updateLegend(data) {
  // the onExtremaChange callback gives us min, max, and the gradientConfig
  // so we can update the legend
  min.innerHTML = data.min;
  max.innerHTML = data.max;
  // regenerate gradient image
  if (data.gradient != gradientCfg) {
    gradientCfg = data.gradient;
    var gradient = legendCtx.createLinearGradient(0, 0, 100, 1);
    for (var key in gradientCfg) {
      gradient.addColorStop(key, gradientCfg[key]);
    }
    legendCtx.fillStyle = gradient;
    legendCtx.fillRect(0, 0, 100, 10);
    gradientImg.src = legendCanvas.toDataURL();
  }
};
/* legend code end */
var heatmapInstance = h337.create({
  container: document.querySelector('.heatmap'),
  // onExtremaChange will be called whenever there's a new maximum or minimum
  onExtremaChange: function(data) {
    updateLegend(data);
  }
});
/* tooltip code start */
var demoWrapper = document.querySelector('.demo-wrapper');
var tooltip = document.querySelector('.tooltip');
function updateTooltip(x, y, value) {
  // + 15 for distance to cursor
  var transl = 'translate(' + (x + 15) + 'px, ' + (y + 15) + 'px)';
  tooltip.style.webkitTransform = transl;
  tooltip.innerHTML = value;
};
demoWrapper.onmousemove = function(ev) {
  var x = ev.layerX;
  var y = ev.layerY;
  // getValueAt gives us the value for a point p(x/y)
  var value = heatmapInstance.getValueAt({
    x: x, 
    y: y
  });
  tooltip.style.display = 'block';
  updateTooltip(x, y, value);
};
// hide tooltip on mouseout
demoWrapper.onmouseout = function() {
  tooltip.style.display = 'none';
};
/* tooltip code end */

 
    </script>

 <script>

var ctx = document.getElementById('myChart').getContext('2d');
//Create gradient
//var gradient = ctx.createLinearGradient(0, 0, 0, 100);
//gradient.addColorStop(0, 'red');
//gradient.addColorStop(0.95, 'yellow');
//gradient.addColorStop(1, 'green');
     var chart = new Chart(ctx, {
	

    // The type of chart we want to create
        type: 'line',
	

    // The data for our dataset
    data: {
        labels: ["1", "2", "3", "4", "5", "6", "7"],
        datasets: [{
            label: "Bilanciamento piede",
            backgroundColor: 'rgba(0, 0, 0, 0)',
            borderColor: 'rgb(50, 10, 10)',
	    lineTension: 0,
            data: [0, 4, -3, 10, -2, -1, 2],
        }]
    },

    // Configuration options go here
    options: {
    annotation: {
      annotations: [{
        type: 'line',
        mode: 'horizontal',
        scaleID: 'y-axis-0',
        value: 4,
        borderColor: 'green',
        borderWidth: 1,
        label: {
          enabled: true,
          content: 'Avampiede'
        }
      },{
        type: 'line',
        mode: 'horizontal',
        scaleID: 'y-axis-0',
        value: -4,
        borderColor: 'green',
        borderWidth: 1,
        label: {
          enabled: true,
          content: 'Retropiede'
        }
      }]
    }
  }
});


</script>
<!-- Aggiungi passo -->
<script>
function addData(chart,passo,valore){
				chart.data.labels.push(passo);

                    chart.data.datasets.forEach(function(dataset) {
                        dataset.data.push(valore);
                    });

				chart.update();
};
</script>
<script>
var barChartData = {
			labels: ['1'],
			datasets: [{
				label: 'Avampiede',
				backgroundColor: '#e04848',
				borderColor: '#e04848',
				borderWidth: 1,
				data: [44]
			}, {
				label: 'Retropiede',
				backgroundColor: '#4864e0',
				borderColor: '#4864e0',
				borderWidth: 1,
				data: [-56]
			}]

		};
        var ctx = document.getElementById('myChart2').getContext('2d');
		var chart2 = new Chart(ctx, {
				type: 'bar',
				data: barChartData,
				options: {
					responsive: true,
					legend: {
						position: 'top',
					},
					title: {
						display: true,
						text: 'Valutazione statica (Valori ideali : AVAMPIEDE 45% RETROPIEDE 55%)'
					}
				},

    // Configuration options go here
            
    options: {
        tooltips: {
						mode: 'index',
						intersect: false
					},
					responsive: true,
					scales: {
						xAxes: [{
							stacked: true,
						}],
						yAxes: [{
							stacked: true
						}]
					},
    annotation: {
      annotations: [{
        type: 'line',
        mode: 'horizontal',
        scaleID: 'y-axis-0',
        value: 45,
        borderColor: 'red',
        borderWidth: 1,
        label: {
          enabled: false,
          content: 'Avampiede'
        }
      },{
        type: 'line',
        mode: 'horizontal',
        scaleID: 'y-axis-0',
        value:-55,
        borderColor: 'blue',
        borderWidth: 1,
	label: {
          enabled: false,
          content: 'Retropiede'
        }
      }]
    }
  }
			});
</script>

 <script>


var ctx = document.getElementById('myChartStabAP').getContext('2d');
//Create gradient
//var gradient = ctx.createLinearGradient(0, 0, 0, 100);
//gradient.addColorStop(0, 'red');
//gradient.addColorStop(0.95, 'yellow');
//gradient.addColorStop(1, 'green');
     var chart = new Chart(ctx, {
	

    // The type of chart we want to create
        type: 'line',
	

    // The data for our dataset
    data: {
        labels: ["1", "2", "3", "4", "5", "6", "7"],
        datasets: [{
            label: "Stabilometria AP",
            backgroundColor: 'rgba(0, 0, 0, 0)',
            borderColor: 'blue',
borderWidth:0.5,
	    lineTension: 0,
            data: [0, 0.1, -1, .2, -1, -1, 0.5],
        }]
    },

    // Configuration options go here
    options: {
    annotation: {
      annotations: [{
        type: 'line',
        mode: 'horizontal',
        scaleID: 'y-axis-0',
        value: 0,
        borderColor: 'green',
        borderWidth: 1
    }]
    }
    }
});

</script>
 <script>


var ctx = document.getElementById('myChartStabML').getContext('2d');
//Create gradient
//var gradient = ctx.createLinearGradient(0, 0, 0, 100);
//gradient.addColorStop(0, 'red');
//gradient.addColorStop(0.95, 'yellow');
//gradient.addColorStop(1, 'green');
     var chart = new Chart(ctx, {
	

    // The type of chart we want to create
        type: 'line',
	

    // The data for our dataset
    data: {
        labels: ["1", "2", "3", "4", "5", "6", "7"],
        datasets: [{
            label: "Stabilometria ML",
            backgroundColor: 'rgba(0, 0, 0, 0)',
            borderColor: 'blue',
borderWidth:0.5,
	    lineTension: 0,
            data: [0, 0.1, -1, .2, -1, -1, 0.5],
        }]
    },

    // Configuration options go here
    options: {
    annotation: {
      annotations: [{
        type: 'line',
        mode: 'horizontal',
        scaleID: 'y-axis-0',
        value: 0,
        borderColor: 'green',
        borderWidth: 1
    }]
    }
    }
});

</script>
